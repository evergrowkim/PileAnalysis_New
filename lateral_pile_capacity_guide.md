# 말뚝 기초 허용 수평 지지력 계산 가이드

## 개요

이 문서는 구조물기초설계기준해설(2018) 및 도로교 설계기준 해설(2008)에 근거한 **말뚝의 허용 수평 지지력** 산정 절차를 개발자가 코드로 정확히 구현할 수 있도록 작성한 기술 가이드이다.

---

## 1. 전체 계산 흐름

```
[입력값 설정]
    ↓
[2.2.1] 수평방향 지반반력계수 Kh 산정 (4가지 방법 → 최소값 채택)
    ↓
[2.2.2] Brom's 방법 → Case-1(변위 기반), Case-2(항복모멘트 기반) → 최대값 / Fs
    ↓
[2.2.3] Chang's 방법 → 수평력 H 직접 산정
    ↓
[2.2.4] Brom's 결과와 Chang's 결과 중 최소값을 최종 적용
```

---

## 2. 입력 파라미터

### 2.1 말뚝 물성

| 파라미터 | 기호 | 단위 | 설명 |
|----------|------|------|------|
| 말뚝 직경 | D | m | 외경 |
| 말뚝 길이 | L | m | 전체 근입장 |
| 탄성계수 | E | kN/m² | 말뚝 재료별 상이 (아래 테이블 참조) |
| 단면2차모멘트 | I | m⁴ | cm⁴ 값을 × 10⁻⁸ 하여 m⁴로 변환 |
| 단면계수 | Z | m³ | cm³ 값을 × 10⁻⁶ 하여 m³로 변환 |
| 항복응력 | σ_yield | kN/m² | 강관=240,000, PHC=20,000 등 재료별 상이 |

#### 말뚝 재료별 탄성계수 (구조물기초설계기준해설 표 5.3.10)

| 말뚝의 종류 | E (kN/m²) |
|-------------|-----------|
| RC 말뚝 | 3.43 × 10⁷ |
| PC 및 PHC 말뚝 | 3.92 × 10⁷ |
| 현장타설 콘크리트 말뚝 | 2.45 × 10⁷ |
| 강관말뚝 | 2.00 × 10⁸ |

> **주의**: 강관말뚝의 E는 PHC의 약 5배이다. 이 차이가 Kh, β, 수평지지력 전체에 큰 영향을 미친다.

### 2.2 지반 물성

| 파라미터 | 기호 | 단위 | 설명 |
|----------|------|------|------|
| N값 (수평반력계수용) | N | blow/30cm | 설계지반면 ~ 1/β 깊이의 **상부지반 대표 N값** |
| 상부지반 유효단위중량 | γ | kN/m³ | 상부 지반 (Brom's 사질토 공식용) |
| 상부지반 내부마찰각 | Φ | ° (도) | 수동토압계수 Kp 산정용 |

#### N값 선정 기준

수평지지력 계산에 사용하는 N값은 **말뚝 전체 깊이의 평균이 아니다**.
설계지반면(GL 0.0)에서 **1/β 깊이까지의 상부지반** 대표 N값을 사용한다.

```
이유: 수평하중은 말뚝 두부 부근 지반에서 주로 저항하므로,
      수평저항에 관여하는 범위(1/β)의 지반 특성만 반영한다.
```

### 2.3 설계 조건

| 파라미터 | 기호 | 단위 | 일반적 값 |
|----------|------|------|-----------|
| 허용변위량 | δ (또는 Y) | cm | 1.5 cm (일반적) |
| 수평력 안전율 | Fs | - | 2.5 |
| α (지반반력 추정 계수) | α | - | 1 (평상시, Eo=2800N 방법) |

---

## 3. 단위계 규칙 (매우 중요)

이 계산에서 **단위 혼용**이 빈번하다. 아래 규칙을 엄격히 준수해야 한다.

### 3.1 유도식의 단위계

```
Kh = 1.208 × (α·Eo)^1.1 × d^(-0.31) × (EI)^(-0.1)
```

이 유도식에서 각 변수의 단위:

| 변수 | 단위 | 비고 |
|------|------|------|
| α·Eo | kN/m² | Eo = 2800 × N 또는 1000 × N |
| d | m | 말뚝 직경 (m 단위) |
| EI | kN·m² | E(kN/m²) × I(m⁴) |
| Kh (결과) | kN/m³ | |

> **주의**: 엑셀에 표시된 큰 숫자(예: 202,000,000,000)는 kgf·cm² 단위의 EI일 수 있으나,
> 유도식에 실제 대입하는 값은 **kN·m² 단위**의 EI이다.
> 코드 구현 시 반드시 kN·m² 단위로 통일한다.

### 3.2 단위 변환 레퍼런스

```
I: cm⁴ → m⁴ : × 1e-8
Z: cm³ → m³ : × 1e-6
D: mm → m   : / 1000
δ: cm → m   : / 100
```

---

## 4. [2.2.1] 수평방향 지반반력계수 Kh 산정

4가지 방법으로 Kh를 산정하고, **최소값**을 최종 적용한다.

### 4.1 방법 1: N값 이용 - 유도식 (Eo = 2800N)

#### 원래 수식 체계 (순환 참조)

```
β = (Kh · D / (4 · EI))^(1/4)        ... ①
Kh = kh0 · (BH / 0.3)^(-3/4)         ... ②
BH = √(D / β)                        ... ③ (말뚝기초)
kh0 = (1/0.3) · α · Eo               ... ④
```

β → BH → Kh → β 로 순환하므로 직접 풀 수 없다.
연립하여 β를 소거하면 아래 **폐합형 유도식**이 도출된다.

#### 유도식 (코드에 구현할 식)

```python
Eo = 2800 * N                          # kN/m²
alpha = 1                              # 평상시 (지진시: 2)
Kh_method1 = 1.208 * (alpha * Eo)**1.1 * D**(-0.31) * (E * I_m4)**(-0.1)
```

> - D: m 단위
> - E * I_m4: kN·m² 단위 (E는 kN/m², I_m4는 m⁴)
> - 결과: kN/m³

#### 검증 예시 (강관 Ø609.6×12t)

```
Eo = 2800 × 10 = 28,000 kN/m²
D = 0.6096 m
EI = 200,000,000 × 0.00101 = 202,000 kN·m²
Kh = 1.208 × 28000^1.1 × 0.6096^(-0.31) × 202000^(-0.1) = 32,362 kN/m³
```

#### 검증 예시 (PHC Ø500)

```
Eo = 2800 × 10 = 28,000 kN/m²
D = 0.50 m
EI = 39,200,000 × 0.00241199 = 94,550 kN·m²
Kh = 1.208 × 28000^1.1 × 0.5^(-0.31) × 94550^(-0.1) = 37,127 kN/m³
```

### 4.2 방법 2: 후쿠오카 공식

```python
Kh_method2 = 6910 * N**0.406          # kN/m³
```

#### 검증: N=10 → 6910 × 10^0.406 = 17,599 kN/m³

### 4.3 방법 3: 요코야마 방법

```python
Kh_method3 = 2000 * N                 # kN/m³
```

#### 검증: N=10 → 20,000 kN/m³

### 4.4 방법 4: 지반공학회 제안식 (Eo = 1000N)

흙의 종류별 Eo/N 값:

| 흙의 종류 | Eo/N |
|-----------|------|
| 실트, 모래질 실트 | 400 |
| 가는 내지 중간모래 | 700 |
| 굵은 모래 | 1000 |
| 모래질 자갈, 자갈 | 1200 ~ 1500 |

일반적으로 **Eo = 1000 × N**을 적용하며, 유도식에 대입한다.

```python
Eo_alt = 1000 * N                      # kN/m²
Kh_method4 = 1.208 * (alpha * Eo_alt)**1.1 * D**(-0.31) * (E * I_m4)**(-0.1)
```

#### 검증 (강관): 1.208 × 10000^1.1 × 0.6096^(-0.31) × 202000^(-0.1) = 10,427 kN/m³
#### 검증 (PHC):  1.208 × 10000^1.1 × 0.5^(-0.31) × 94550^(-0.1) = 11,962 kN/m³

### 4.5 최종 Kh 결정

```python
Kh = min(Kh_method1, Kh_method2, Kh_method3, Kh_method4)
```

---

## 5. β 계산 (Kh 확정 후)

Kh가 확정되면, β를 수식 ①로 역산한다.

```python
beta = (Kh * D / (4 * E * I_m4))**(1/4)    # m⁻¹
inv_beta = 1.0 / beta                       # m (수평저항 관여 깊이)
```

#### 검증 (강관, Kh=10,427)

```
β = (10427 × 0.6096 / (4 × 202000))^(1/4) = 0.2978 m⁻¹
1/β = 3.36 m
```

#### 검증 (PHC, Kh=11,962)

```
β = (11962 × 0.5 / (4 × 94550))^(1/4) = 0.3546 m⁻¹
1/β = 2.82 m
```

---

## 6. [2.2.2] Brom's 방법

### 6.1 말뚝 유형 판별 (사질토)

```python
# η 계산 (사질토)
z = 1.0 / beta                             # 1/β (m)
nh = Kh * D / z                            # 수평 지반반력 상수 (kN/m³)
eta = (nh / (E * I_m4))**(1/5)             # m⁻¹

eta_L = eta * L                             # 무차원수
```

판별 기준:

| 조건 | 말뚝 유형 |
|------|----------|
| η·L < 2.0 | 짧은 말뚝 |
| 2.0 ≤ η·L ≤ 4.0 | 중간 말뚝 |
| η·L > 4.0 | **긴 말뚝** (일반적) |

> 실무에서 대부분 η·L > 4.0이므로, **긴 말뚝** 공식을 적용한다.

### 6.2 수동토압계수 Kp

```python
Kp = (1 + math.sin(math.radians(phi))) / (1 - math.sin(math.radians(phi)))
```

검증: Φ=27° → Kp = (1+0.4540)/(1-0.4540) = 2.663 ≈ 2.66~2.69

### 6.3 Case-1: 변위 기반 (허용변위량에서 역산)

이 방법은 말뚝머리에 **허용변위 δ**를 가할 때 발생하는 수평력을 구하고,
그 수평력에 의한 항복모멘트로 극한수평력을 산정하는 방식이다.

#### 순서

```python
delta_m = delta_cm / 100.0                  # cm → m

# 1단계: 말뚝머리 변위에 저항하는 수평력 H
H = 4 * beta**3 * (E * I_m4) * delta_m      # kN

# 2단계: 항복휨모멘트 My
My = H / (2 * beta)                          # kN·m

# 3단계: 극한수평력 Hu (긴말뚝 - 사질토)
Hu = 2.38 * (My / (Kp * gamma * D**4))**(2/3) * Kp * gamma * D**3    # kN

# 4단계: 허용수평지지력
Ha_case1 = Hu / Fs                           # kN
```

#### 검증 (강관 Ø609.6)

```
H = 4 × 0.2978³ × 202000 × 0.015 = 320.15 kN
My = 320.15 / (2 × 0.2978) = 537.5 kN·m
Hu = 2.38 × (537.5 / (2.66 × 18.0 × 0.6096⁴))^(2/3) × 2.66 × 18.0 × 0.6096³ = 486.1 kN
Ha = 486.1 / 2.5 = 194.4 kN
```

#### 검증 (PHC Ø500)

```
H = 4 × 0.3546³ × 94550 × 0.015 = 253.0 kN
My = 253.0 / (2 × 0.3546) = 356.7 kN·m
Hu = 2.38 × (356.7 / (2.69 × 18.0 × 0.5⁴))^(2/3) × 2.69 × 18.0 × 0.5³ = 346.2 kN
Ha = 346.2 / 2.5 = 138.5 kN
```

### 6.4 Case-2: 항복모멘트 기반 (말뚝 재료의 항복 모멘트)

이 방법은 말뚝 재료가 항복할 때의 **실제 항복모멘트 My**를 직접 산정한다.

```python
# 1단계: 단면계수 Z (정밀 계산)
Z_m3 = I_m4 / (D / 2)                       # m³ (= 2I/D)

# 2단계: 항복모멘트
My = Z_m3 * sigma_yield                      # kN·m

# 3단계: 극한수평력 Hu (동일 공식)
Hu = 2.38 * (My / (Kp * D**4 * gamma))**(2/3) * Kp * D**3 * gamma    # kN

# 4단계: 허용수평지지력
Ha_case2 = Hu / Fs                           # kN
```

#### 핵심 차이: σ_yield 값이 말뚝 재료별로 크게 다름

| 말뚝 종류 | σ_yield (kN/m²) | 비고 |
|-----------|-----------------|------|
| 강관말뚝 | 240,000 | SS400 기준 |
| PHC 말뚝 | 20,000 | 콘크리트 허용응력 기준 |

> 강관의 σ_yield는 PHC의 **12배**이므로, Case-2 결과가 매우 다르다.
> 강관: Ha_case2 ≈ 252 kN, PHC: Ha_case2 ≈ 92 kN

#### 검증 (강관 Ø609.6)

```
Z = 101000 cm⁴ / (60.96/2 cm) = 3313.6 cm³ → 0.003314 m³
My = 0.003314 × 240,000 = 795.3 kN·m
Hu = 2.38 × (795.3 / (2.66 × 0.6096⁴ × 18.0))^(2/3) × 2.66 × 0.6096³ × 18.0 = 631.2 kN
Ha = 631.2 / 2.5 = 252.5 kN
```

#### 검증 (PHC Ø500)

```
Z = 241199 cm⁴ / (50/2 cm) = 9648 cm³ → 0.009648 m³
My = 0.009648 × 20,000 = 193.0 kN·m
Hu = 2.38 × (193.0 / (2.69 × 0.5⁴ × 18.0))^(2/3) × 2.69 × 0.5³ × 18.0 = 229.9 kN
Ha = 229.9 / 2.5 = 91.9 kN
```

### 6.5 Brom's 최종 결과

Case-1과 Case-2 중 **지배적인(작은) 값**을 Brom's 결과로 채택한다.

```python
Ha_broms = min(Ha_case1, Ha_case2)
```

> 실무적으로:
> - **강관말뚝**: Case-1(변위 기반)이 지배적 → 194 kN
> - **PHC 말뚝**: Case-2(항복모멘트 기반)이 지배적 → 92 kN

---

## 7. [2.2.3] Chang's 방법

### 공식

```python
# β는 위에서 이미 산정됨 (Kh 확정 후)
H_chang = (Y_m) * Kh * D / beta        # kN
```

여기서:
- Y_m = 허용기준변위량 (m) = δ / 100
- Kh = 최종 적용 지반반력계수 (kN/m³)
- D = 말뚝 직경 (m)
- β = 기초의 특성치 (m⁻¹)

#### 검증 (강관)

```
H = 0.015 × 10,427 × 0.6096 / 0.2978 = 320.1 kN
```

#### 검증 (PHC)

```
H = 0.015 × 11,962 × 0.5 / 0.3546 = 253.0 kN
```

> Chang's 방법은 안전율이 이미 허용변위 개념에 내포되어 있으므로 별도 Fs를 나누지 않는다.

---

## 8. [2.2.4] 최종 수평지지력 결정

```python
Ha_final = min(Ha_broms, H_chang)
```

| 예시 | Brom's (kN) | Chang's (kN) | 최종 적용 (kN) |
|------|-------------|--------------|----------------|
| 강관 Ø609.6×12t | 252.5 | 320.1 | **252.5** |
| PHC Ø500 | 91.9 | 253.0 | **91.9** |

---

## 9. 전체 코드 구현 (Python 함수)

아래는 위 로직을 하나의 함수로 통합한 구현 예시이다.

```python
import math

def calc_lateral_capacity(
    D_mm: float,         # 말뚝 직경 (mm)
    L_m: float,          # 말뚝 길이 (m)
    E_kNm2: float,       # 탄성계수 (kN/m²)
    I_cm4: float,        # 단면2차모멘트 (cm⁴)
    N: float,            # 수평반력계수용 N값
    phi_deg: float,      # 상부지반 내부마찰각 (°)
    gamma: float,        # 상부지반 유효단위중량 (kN/m³)
    sigma_yield: float,  # 말뚝 항복응력 (kN/m²)
    delta_cm: float = 1.5,  # 허용변위 (cm)
    alpha: float = 1.0,     # α 계수 (평상시=1, 지진시=2)
    Fs: float = 2.5,        # 수평력 안전율
    Eo_N_ratio: float = 1000,  # 지반공학회 Eo/N 비율
) -> dict:
    """
    말뚝 허용 수평 지지력 계산
    
    Returns:
        dict with keys:
        - Kh_method1 ~ Kh_method4: 각 방법별 Kh (kN/m³)
        - Kh: 최종 적용 Kh (최소값)
        - beta: 기초 특성치 (m⁻¹)
        - eta_L: η·L (말뚝 유형 판별)
        - broms_case1_Ha: Case-1 허용수평지지력 (kN)
        - broms_case2_Ha: Case-2 허용수평지지력 (kN)
        - broms_Ha: Brom's 최종 결과 (kN)
        - chang_H: Chang's 수평력 (kN)
        - Ha_final: 최종 허용 수평 지지력 (kN)
    """
    
    # --- 단위 변환 ---
    D = D_mm / 1000.0           # m
    I_m4 = I_cm4 * 1e-8         # m⁴
    EI = E_kNm2 * I_m4          # kN·m²
    delta_m = delta_cm / 100.0  # m
    
    # --- 2.2.1 지반반력계수 Kh ---
    
    # 방법 1: Eo = 2800N
    Eo_2800 = 2800 * N
    Kh_m1 = 1.208 * (alpha * Eo_2800)**1.1 * D**(-0.31) * EI**(-0.1)
    
    # 방법 2: 후쿠오카
    Kh_m2 = 6910 * N**0.406
    
    # 방법 3: 요코야마
    Kh_m3 = 2000 * N
    
    # 방법 4: 지반공학회 (Eo = Eo_N_ratio × N)
    Eo_alt = Eo_N_ratio * N
    Kh_m4 = 1.208 * (alpha * Eo_alt)**1.1 * D**(-0.31) * EI**(-0.1)
    
    # 최소값 적용
    Kh = min(Kh_m1, Kh_m2, Kh_m3, Kh_m4)
    
    # --- β 산정 ---
    beta = (Kh * D / (4.0 * EI))**(1.0/4.0)
    
    # --- 말뚝 유형 판별 ---
    z = 1.0 / beta
    nh = Kh * D / z
    eta = (nh / EI)**(1.0/5.0)
    eta_L = eta * L_m
    
    if eta_L < 2.0:
        pile_class = "short"
    elif eta_L <= 4.0:
        pile_class = "medium"
    else:
        pile_class = "long"
    
    # --- Kp (수동토압계수) ---
    Kp = (1.0 + math.sin(math.radians(phi_deg))) / \
         (1.0 - math.sin(math.radians(phi_deg)))
    
    # --- Brom's Case-1: 변위 기반 ---
    H1 = 4.0 * beta**3 * EI * delta_m
    My1 = H1 / (2.0 * beta)
    Hu1 = 2.38 * (My1 / (Kp * gamma * D**4))**(2.0/3.0) \
              * Kp * gamma * D**3
    Ha1 = Hu1 / Fs
    
    # --- Brom's Case-2: 항복모멘트 기반 ---
    D_cm = D * 100.0
    Z_m3 = (I_cm4 / (D_cm / 2.0)) * 1e-6  # m³
    My2 = Z_m3 * sigma_yield
    Hu2 = 2.38 * (My2 / (Kp * D**4 * gamma))**(2.0/3.0) \
              * Kp * D**3 * gamma
    Ha2 = Hu2 / Fs
    
    # --- Brom's 최종 ---
    Ha_broms = min(Ha1, Ha2)
    
    # --- Chang's 방법 ---
    H_chang = delta_m * Kh * D / beta
    
    # --- 최종 결과 ---
    Ha_final = min(Ha_broms, H_chang)
    
    return {
        'Kh_method1': Kh_m1,
        'Kh_method2': Kh_m2,
        'Kh_method3': Kh_m3,
        'Kh_method4': Kh_m4,
        'Kh': Kh,
        'beta': beta,
        'inv_beta': 1.0 / beta,
        'nh': nh,
        'eta': eta,
        'eta_L': eta_L,
        'pile_class': pile_class,
        'Kp': Kp,
        'EI': EI,
        'broms_case1_H': H1,
        'broms_case1_My': My1,
        'broms_case1_Hu': Hu1,
        'broms_case1_Ha': Ha1,
        'broms_case2_Z': Z_m3,
        'broms_case2_My': My2,
        'broms_case2_Hu': Hu2,
        'broms_case2_Ha': Ha2,
        'broms_Ha': Ha_broms,
        'chang_H': H_chang,
        'Ha_final': Ha_final,
    }
```

---

## 10. 검증 테스트 케이스

### Test 1: 강관말뚝 Ø609.6 × 12t

```python
result = calc_lateral_capacity(
    D_mm=609.6,
    L_m=17.81,
    E_kNm2=200_000_000,
    I_cm4=101_000,
    N=10,
    phi_deg=27,
    gamma=18.0,
    sigma_yield=240_000,
)
```

| 항목 | 기댓값 | 허용오차 |
|------|--------|----------|
| Kh_method1 | 32,362 kN/m³ | ±100 |
| Kh_method4 | 10,427 kN/m³ | ±50 |
| Kh (최종) | 10,427 kN/m³ | ±50 |
| β | 0.2978 m⁻¹ | ±0.001 |
| η·L | 7.00 | ±0.1 |
| Case-1 Ha | 194 kN | ±5 |
| Case-2 Ha | 252 kN | ±5 |
| Chang's H | 320 kN | ±5 |
| **최종 Ha** | **252 kN** | ±5 |

### Test 2: PHC 말뚝 Ø500

```python
result = calc_lateral_capacity(
    D_mm=500,
    L_m=10.0,
    E_kNm2=39_200_000,
    I_cm4=241_199,
    N=10,
    phi_deg=27,
    gamma=18.0,
    sigma_yield=20_000,
)
```

| 항목 | 기댓값 | 허용오차 |
|------|--------|----------|
| Kh_method1 | 37,127 kN/m³ | ±200 |
| Kh_method4 | 11,962 kN/m³ | ±50 |
| Kh (최종) | 11,962 kN/m³ | ±50 |
| β | 0.3546 m⁻¹ | ±0.001 |
| η·L | 4.68 | ±0.1 |
| Case-1 Ha | 138 kN | ±5 |
| Case-2 Ha | 92 kN | ±5 |
| Chang's H | 253 kN | ±5 |
| **최종 Ha** | **92 kN** | ±5 |

---

## 11. 주의사항 및 엣지 케이스

### 11.1 Brom's 적용 공식 선택

이 가이드에서 다루는 공식은 **사질토 + 긴말뚝 (η·L > 4.0)** 조건이다.
만약 η·L ≤ 4.0이거나 점성토 지반이면 다른 공식을 사용해야 한다.

### 11.2 Brom's Case-1 vs Case-2의 물리적 의미

| Case | 의미 | 지배 조건 |
|------|------|-----------|
| Case-1 | 허용변위 δ에서의 수평력으로부터 항복모멘트를 역산 | 지반이 약하거나 말뚝이 강성이 높을 때 |
| Case-2 | 말뚝 재료의 실제 항복모멘트 사용 | 말뚝 재료가 약할 때 (PHC 등) |

> **강관말뚝**: 재료 강도가 높으므로 Case-2 > Case-1 → **Case-1 지배**가 아님.
> 실제로는 Case-2가 더 크지만, 엑셀에서는 Case-2 결과를 Brom's 대표값으로 사용하는 경우도 있다.
> 보수적 설계를 위해 **min(Case-1, Case-2)**를 적용하는 것이 일반적이다.

### 11.3 Brom's vs Chang's 최종 선택

엑셀에서는 Brom's와 Chang's 중 **최소값**을 적용한다.
단, 일부 설계에서는 Brom's Case-2만을 대표로 사용하는 관행도 있으므로,
원본 엑셀의 최종 적용 로직을 반드시 확인해야 한다.

### 11.4 부식 두께 적용

강관말뚝의 경우 단면2차모멘트(I)와 단면계수(Z)는 **부식 두께 공제 후** 값을 사용해야 한다.
강관말뚝 사양 테이블에서 읽어오는 I, Z 값이 이미 부식 공제 후인지 확인 필요.

---

## 12. 요약 플로우차트

```
입력: D, L, E, I, N, Φ, γ, σ_yield, δ, α, Fs
        │
        ▼
  ┌─────────────────────────────────┐
  │  Kh 산정 (4가지 방법)           │
  │  ① 유도식(Eo=2800N)            │
  │  ② 후쿠오카                     │
  │  ③ 요코야마                     │
  │  ④ 유도식(Eo=1000N)            │
  │  → Kh = min(①,②,③,④)          │
  └──────────┬──────────────────────┘
             │
             ▼
  ┌─────────────────────────────────┐
  │  β = (Kh·D / 4EI)^(1/4)        │
  └──────────┬──────────────────────┘
             │
     ┌───────┴───────┐
     ▼               ▼
  Brom's           Chang's
  ┌──────────┐   ┌──────────────────┐
  │ Case-1   │   │ H = Y·Kh·D / β   │
  │ Case-2   │   └────────┬─────────┘
  │ → min    │            │
  └────┬─────┘            │
       │                  │
       ▼                  ▼
  ┌─────────────────────────────────┐
  │  Ha_final = min(Broms, Chang)   │
  └─────────────────────────────────┘
```
